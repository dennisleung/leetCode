<!DOCTYPE html>
<body>
<script>

function ListNode(val) {
    this.val = val;
    this.next = null;
}

function TreeNode(val) {
    this.val = val;
    this.left = null;
    this.right = null;
}

const makeLink = (arr)=>{
    if(!arr.length) {
        return null;
    }
    let head = cur = new ListNode();
    arr.forEach((v)=>{
        cur.next = new ListNode(v);
        cur = cur.next;
    });

    return head.next;
}

const makeTree = (arr)=>{
    let head = new TreeNode(arr.shift());
    let nodes = [head];
    while(arr.length) {
        let node = nodes.shift();
        let left = arr.shift();
        let right = arr.shift();
        if(left||left===0) {
            node.left = new TreeNode(left);
            nodes.push(node.left);
        }
        if(right||right===0) {
            node.right = new TreeNode(right);
            nodes.push(node.right);
        }
    }

    return head;
}

function Node(val,isLeaf,topLeft,topRight,bottomLeft,bottomRight) {
    this.val = val;
    this.isLeaf = isLeaf;
    this.topLeft = topLeft;
    this.topRight = topRight;
    this.bottomLeft = bottomLeft;
    this.bottomRight = bottomRight;
};

function TreeNode2(val, children) {
    this.val = val;
    this.children = children;
}

const bfs = function(root) {
    let nodes = [];
    let queue = [root];
    while(queue.length) {
        let node = queue.shift();
        nodes.push(node);
        if(node.left) {
            queue.push(node.left);
        }
        if(node.right) {
            queue.push(node.right);
        }
    }

    return nodes;
};

//先序遍历
const preorderTraversal = function(root) {
    const getLeftChildren = function(node) {
        if(node.left) {
            return preorderTraversal(node.left);
        }else {
            return [];
        }
    };

    const getRightChildren = function(node) {
        if(node.right) {
            return preorderTraversal(node.right);
        }else {
            return [];
        }
    };

    return getLeftChildren(root).concat([root]).concat(getRightChildren(root));
};

const getComplement = function(num, bit=32) {
    let x = Math.abs(num).toString(2);
    x = ((new Array(bit)).fill("0").join("") + x).slice(-32)
    if(num<0) {
        let xArr = x.split("");
        let caret = 1;
        for(let i = xArr.length-1; i>=0; i--) {
            xArr[i] = xArr[i]==="1" ? "0" : "1";
            if(caret) {
                if(xArr[i]==="1") {
                    xArr[i] = "0";
                }else {
                    caret = 0;
                    xArr[i] = "1";
                }
            }
        }

        x = xArr.join("");
    }

    return x;
};

const deconstructToPrimie = (num)=>{
    const result = [];
    let cursor = 2;
    while(num>1) {
        if(num%cursor==0) {
            result.push(cursor);
            num /= cursor;
        }else {
            cursor++;
        }
    }

    return result;
};

const isPrime = (num)=>{
    if(num==1) {
        return false;
    }
    let cursor = 2;
    const sqrt = ~~Math.sqrt(num);
    while(num>1 && cursor<=sqrt) {
        if(num%cursor==0) {
            return false;
        }
        cursor++;
    }

    return true;
};

const getDivisors = function(num) {
    const result = {};
    for(let i = 1, max = ~~Math.sqrt(num); i<=max; i++) {
        let another = ~~(num/i);
        if(i*another==num) {
            result[i] = 1;
            result[another] = 1;
        }
    }

    return Object.keys(result);
};

function Node(val, isLeaf,topLeft,topRight,bottomLeft,bottomRight) {
    this.val = val;
    this.isLeaf = isLeaf;
    this.topLeft = topLeft;
    this.topRight = topRight;
    this.bottomLeft = bottomLeft;
    this.bottomRight = bottomRight;
};

const dfs = (root)=>{
    if(!root) {
        return [];
    }
    return [root].concat(dfs(root.left), dfs(root.right));
};

/**
 * @param {Node} root
 * @return {number[]}
 */
var postorder = function(root) {
    const result = [];
    const travels = (node) => {
        if(!node) {
            return;
        }
        (node.children||[]).forEach((child)=>{
            travels(child);
        });
        result.push(node.val);
    };

    travels(root);
    return result;
};

const getGroup = function(arr, count) {
    let mid = ~~(arr.length/2);
    getGroup(arr.slice(0, mid), 1)
    getGroup(arr.slice(mid), count-1)

    getGroup(arr.slice(0, mid), count-1)
    getGroup(arr.slice(mid), 1)
};

/**
 * @param {number[]} nums
 * @param target
 * @return {number[][]}
 */
 var threeSum = function(nums, target) {
    const cache = {};
    for(let num of nums) {
        cache[num] = (cache[num] || 0) + 1;
    }

    let result = {};
    nums.sort((a, b)=>a-b);
    for(let i = 0; i<nums.length; i++) {
        let low = i+1;
        let high = nums.length-1;
        while(low<high) {
            let r = nums[i] + nums[low] + nums[high];
            if(r>target) {
                high--;
            }else if(r<target){
                low++;
            }else {
                result[`${nums[i]}_${nums[low]}_${nums[high]}`] = [nums[i], nums[low], nums[high]];
                low++;
                high--;
            }
        }
    }

    return Object.values(result);
};

/**
 * @param {number[]} nums
 * @param {number} target
 * @return {number[][]}
 */
var fourSum = function(nums, target) {
    const cache = {};
    for(let i = 0; i<nums.length; i++) {
        let result = threeSum(nums.slice(0, i).concat(nums.slice(i+1)), target-nums[i]);
        for(let arr of result) {
            arr = [...arr, nums[i]];
            let cacheKey = arr.sort((a,b)=>a-b).join("_");
            if(!cache[cacheKey]) {
                cache[cacheKey] = arr;
            }
        }
    }
    
    return Object.values(cache);
};
console.log(fourSum([1, 0, -1, 0, -2, 2], 0));
// [
//   [-1,  0, 0, 1],
//   [-2, -1, 1, 2],
//   [-2,  0, 0, 2]
// ]
console.log(fourSum([-500,-481,-480,-469,-437,-423,-408,-403,-397,-381,-379,-377,-353,-347,-337,-327,-313,-307,-299,-278,-265,-258,-235,-227,-225,-193,-192,-177,-176,-173,-170,-164,-162,-157,-147,-118,-115,-83,-64,-46,-36,-35,-11,0,0,33,40,51,54,74,93,101,104,105,112,112,116,129,133,146,152,157,158,166,177,183,186,220,263,273,320,328,332,356,357,363,372,397,399,420,422,429,433,451,464,484,485,498,499], 2139));
console.log(fourSum([-5,5,4,-3,0,0,4,-2], 4));//[[-5,0,4,5],[-3,-2,4,5]]
console.log(fourSum([-474,-445,-442,-426,-410,-382,-369,-367,-356,-351,-339,-335,-335,-320,-318,-313,-276,-250,-227,-215,-209,-209,-200,-198,-189,-183,-154,-149,-138,-134,-121,-110,-97,-93,-86,-66,-61,-54,-33,-12,-9,2,6,13,30,59,82,86,88,111,132,159,162,193,204,220,225,229,231,275,314,327,332,386,400,440,452,457,485], 3456));

</script>
</body>
